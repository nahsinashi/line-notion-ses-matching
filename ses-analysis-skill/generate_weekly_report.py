# SES営業分析システム - 週次レポート生成スクリプト
# 対象週: 2025年1月第4週（1/20-1/26）

import json
from datetime import datetime, timedelta

def generate_weekly_report():
    """週次レポートのテンプレートを生成"""

    # 対象期間
    week_start = datetime(2025, 1, 20)
    week_end = datetime(2025, 1, 26)
    week_label = "2025年1月第4週（1/20-1/26）"

    # レポートテンプレート
    report = f"""# 📊 週次レポート - {week_label}

**レポート作成日**: {datetime.now().strftime('%Y年%m月%d日')}

---

## 💰 営業コスト

| 項目 | 値 |
|------|-----|
| 累積稼働時間 | [手動入力] h |
| 週間予算時間 | 40.0 h |
| 予算消化率 | [計算] % |
| 時間単価 | ¥5,000/h |
| 実績金額 | ¥[計算] |
| 予算金額 | ¥200,000 |

**💡 コメント**: 営業コスト管理DBに週次データを入力してください。

---

## ⚠️ 期限超過アラート

### 📋 提案DB（ステータス「提案中」で提案日から1週間以上経過）

**対象期間**: {week_start.strftime('%Y-%m-%d')} 以前の提案

| 提案名 | 提案日 | 経過日数 | ステータス | 案件担当 | 要員担当 |
|--------|--------|----------|------------|----------|----------|
| [手動で確認] | - | - | - | - | - |

### 👤 要員DB（ステータス≠「終了」で要員回収日から2週間以上経過）

**対象期間**: {(week_end - timedelta(days=14)).strftime('%Y-%m-%d')} 以前の登録

| 要員名 | 要員回収日 | 経過日数 | ステータス | 担当 |
|--------|------------|----------|------------|------|
| [手動で確認] | - | - | - | - |

### 🧾 案件DB（ステータス≠「終了」で案件回収日から2週間以上経過）

**対象期間**: {(week_end - timedelta(days=14)).strftime('%Y-%m-%d')} 以前の登録

| 案件名 | 案件回収日 | 経過日数 | ステータス | 担当 |
|--------|------------|----------|------------|------|
| [手動で確認] | - | - | - | - |

---

## 📋 提案活動（{week_label}）

### 📊 提案サマリー

| 指標 | 件数 |
|------|------|
| 新規登録（候補） | [Notionで確認] 件 |
| 提案中 | [Notionで確認] 件 |
| 面談 | [Notionで確認] 件 |
| 結果待ち | [Notionで確認] 件 |
| 決定 | [Notionで確認] 件 |
| 見送り | [Notionで確認] 件 |
| 辞退 | [Notionで確認] 件 |

### ✅ 決定案件（{week_label}）

**該当期間**: 提案日が {week_start.strftime('%Y/%m/%d')} ~ {week_end.strftime('%Y/%m/%d')} でステータス「決定」

| 提案名 | 提案日 | 案件担当 | 要員担当 | 粗利見込 |
|--------|--------|----------|----------|----------|
| [Notionで確認] | - | - | - | - |

---

## 👤 要員活動（{week_label}）

### 📊 要員サマリー

| 指標 | 件数 |
|------|------|
| 新規登録 | [Notionで確認] 件 |
| 営業中 | [Notionで確認] 件 |
| 面談調整中 | [Notionで確認] 件 |
| オファー | [Notionで確認] 件 |
| 終了 | [Notionで確認] 件 |

---

## 🧾 案件活動（{week_label}）

### 📊 案件サマリー

| 指標 | 件数 |
|------|------|
| 新規登録 | [Notionで確認] 件 |
| 営業中 | [Notionで確認] 件 |
| 面談調整中 | [Notionで確認] 件 |
| 決定 | [Notionで確認] 件 |
| 終了 | [Notionで確認] 件 |

---

## 📝 次週アクション

1. **期限超過フォロー**
   - 提案DB: 1週間経過案件の状況確認
   - 要員DB: 2週間経過要員の状況確認
   - 案件DB: 2週間経過案件の状況確認

2. **営業活動**
   - 面談・結果待ち案件のフォローアップ
   - 新規提案の促進
   - 営業中案件の進捗確認

3. **データメンテナンス**
   - ステータス更新漏れの確認
   - メモ欄の記入促進

---

## 📌 備考

- このレポートはテンプレートです。Notionで各データベースを確認して、実際の数値を入力してください。
- 営業コスト管理DBに週次データを入力すると、自動でコスト計算されます。
- 期限超過アラートは、各データベースのビューでフィルタリングして確認できます。

---

**レポート生成**: Claude Code SES Analysis Skill v1.0.0
"""

    return report

if __name__ == "__main__":
    report = generate_weekly_report()
    print(report)

    # ファイルに保存
    with open("weekly_report_2025_01_20.md", "w", encoding="utf-8") as f:
        f.write(report)

    print("\n\n=== レポートを weekly_report_2025_01_20.md に保存しました ===")
