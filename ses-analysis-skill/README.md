# SES営業分析レポート生成スキル

SES仲介営業における案件・要員・提案状況を週次・月次で自動分析し、Notionレポートとして可視化するClaude Codeスキルです。

## 機能

- 📊 **週次レポート生成**: 週間の営業活動を自動集計・分析
- 📈 **月次レポート生成**: 月間の営業成果をトレンド分析
- ⚠️ **期限超過アラート**: 対応が必要な案件を自動抽出（週次のみ）
- 📉 **グラフ可視化**: 高品質なグラフで視覚的に分析
- 🔄 **履歴管理**: 過去のレポートを自動保存

## 使い方

### 週次レポート生成

```bash
/ses-analysis weekly
```

今週のレポートを生成します。

特定の週を指定する場合:

```bash
/ses-analysis weekly --date 2025-01-20
```

### 月次レポート生成

```bash
/ses-analysis monthly
```

今月のレポートを生成します。

特定の月を指定する場合:

```bash
/ses-analysis monthly --month 2025-01
```

## データソース

このスキルは以下のNotion データベースからデータを取得します:

- **提案DB**: 案件と要員のマッチング提案情報
- **要員DB**: 稼働可能な要員情報
- **案件DB**: クライアント案件情報
- **営業コスト管理DB**: チームの稼働時間とコスト

## レポート内容

### 週次レポート

- 💰 営業コスト（予算消化率、実績金額）
- ⚠️ 期限超過アラート（提案・要員・案件）
- 📋 提案活動（新規登録、決定、見送り、辞退）
- 👤 要員活動（新規登録、終了）
- 🧾 案件活動（新規登録、決定、終了）
- 📊 週間分析（決定率、コスト効率、スキルマッチング）
- 📈 グラフ可視化（6種類）

### 月次レポート

- 💰 月間営業コスト（週別集計）
- 📋 提案活動（決定案件、進行中の重要案件）
- 👤 要員活動（進行中の重要要員）
- 🧾 案件活動（決定案件、進行中の重要案件）
- 📊 月間総合分析（KPI、前月比）
- 📈 3ヶ月トレンド
- 📉 グラフ可視化（5種類）

## セットアップ

### 前提条件

1. Notion APIへのアクセス権限
2. 各データベースへの接続権限
3. 分析レポート出力先ページの作成

### 初回設定

1. `skill.json` でスキルを登録
2. Notion統合を各DBに接続
3. 営業コスト管理DBに初期データを入力

詳細は要件定義書を参照してください。

## 技術スタック

- **言語**: Python 3
- **ライブラリ**:
  - `requests`: Notion API操作（REST API直接呼び出し）
  - `datetime`: 日付計算
- **グラフ生成**: QuickChart.io（URL生成方式）
- **Notion API**: v2022-06-28

## 要件定義

詳細な要件定義は、セットアップ時に作成された要件定義書を参照してください。

## トラブルシューティング

### Notion API接続エラー

```
Error: Could not connect to Notion API
```

→ Notion統合のアクセス権限を確認してください

### データ取得エラー

```
Error: No data found for the specified period
```

→ 対象期間にデータが存在するか確認してください

### グラフ生成エラー

```
Warning: Graph generation failed, continuing with text-only report
```

→ テキストのみでレポートが生成されます。QuickChart.ioへのネットワーク接続を確認してください。

## バージョン

- **v1.0.0**: 初回リリース
  - 週次・月次レポート生成
  - 期限超過アラート
  - グラフ可視化

## ライセンス

このスキルは個人使用・社内使用に限定されます。

## 作成者

Claude Code + 要件定義による自動生成
